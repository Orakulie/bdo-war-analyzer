(function(e){function t(t){for(var a,l,n=t[0],o=t[1],c=t[2],u=0,g=[];u<n.length;u++)l=n[u],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&g.push(i[l][0]),i[l]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);d&&d(t);while(g.length)g.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,n=1;n<s.length;n++){var o=s[n];0!==i[o]&&(a=!1)}a&&(r.splice(t--,1),e=l(l.s=s[0]))}return e}var a={},i={app:0},r=[];function l(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=e,l.c=a,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(s,a,function(t){return e[t]}.bind(null,a));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/OUTDATED-war-analyzer/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var d=o;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},"0b6a":function(e,t,s){"use strict";s("8c67")},2984:function(e,t,s){"use strict";s("540e")},"540e":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",[s("v-main",[s("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[s("router-view")],1)],1)],1)},r=[],l={name:"App",data:()=>({})},n=l,o=(s("034f"),s("2877")),c=s("6544"),d=s.n(c),u=s("7496"),g=s("f6c4"),h=Object(o["a"])(n,i,r,!1,null,null,null),p=h.exports;d()(h,{VApp:u["a"],VMain:g["a"]});var m=s("8c4f"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"page",attrs:{id:"inspire"}},[s("v-main",{staticClass:"pt-0",staticStyle:{display:"flex","align-items":"center"}},[s("v-container",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[s("div",{staticClass:"text-center text-h2 mb-5"},[e._v("War Analyzer")]),s("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var a=t.hover;return[s("v-sheet",{staticClass:"ma-5",staticStyle:{border:"solid #2196f3 2px"},attrs:{rounded:"",height:"30vh",width:"50%",elevation:a?6:2},on:{click:function(t){return e.$refs.fileUpload.click()}}},[s("div",{ref:"dropContainer",staticStyle:{height:"100%"}},[0==e.images.length?s("div",{staticClass:"dropContainer"},[e._v(" Drag or click to upload! ")]):e._e(),s("v-container",{staticStyle:{display:"flex","flex-wrap":"wrap","justify-content":"space-evenly","max-height":"100%","overflow-y":"auto"}},[e._l(e.images,(function(t){return s("v-card",{key:t.name,staticClass:"ma-1",staticStyle:{width:"115px"}},[s("v-app-bar",{attrs:{dense:"",flat:"",color:"rgba(0, 0, 0, 0)",elevation:"0"}},[s("v-toolbar-title",{staticClass:"white--text pl-0"},[e._v(" "+e._s(t.name)+" ")]),s("v-spacer"),s("v-btn",{attrs:{color:"white",icon:"",dense:"",small:""},on:{click:function(s){s.stopPropagation(),e.images.splice(e.images.indexOf(t),1)}}},[s("v-icon",{attrs:{small:"",dense:""}},[e._v("mdi-close")])],1)],1),s("v-card-text",{staticClass:"text-center pt-0"})],1)})),e._l(10,(function(e){return s("v-card",{key:e,staticClass:"mx-1",staticStyle:{"background-color":"transparent"},attrs:{flat:"",height:"0",width:"115"}})}))],2)],1)])]}}])}),s("input",{ref:"fileUpload",attrs:{type:"file",accept:"image/*, .json",hidden:"",multiple:"multiple"}}),s("v-row",{staticClass:"justify-center mt-5"},[s("v-btn",{ref:"analyzeButton",attrs:{outlined:"",color:"primary",dark:"",disabled:0==e.images.length},on:{click:function(t){return e.$router.push({name:"Analyze",params:{images:e.images,settings:e.settings}})}}},[e._v("Analyze")])],1),s("v-row",{staticClass:"justify-center mt-5"},[s("v-dialog",{attrs:{transition:"dialog-bottom-transition",width:"50%"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,i=t.attrs;return[s("v-btn",e._g(e._b({attrs:{color:"primary",dark:"",icon:""}},"v-btn",i,!1),a),[s("v-icon",[e._v("mdi-cog")])],1)]}}]),model:{value:e.settingsDialog,callback:function(t){e.settingsDialog=t},expression:"settingsDialog"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",color:"primary"}},[s("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.settingsDialog=!1}}},[s("v-icon",[e._v("mdi-close")])],1),s("v-toolbar-title",[e._v("Settings")]),s("v-spacer"),s("v-toolbar-items")],1),s("v-divider"),s("v-list",{attrs:{"three-line":"",subheader:""}},[s("v-subheader",[e._v("General")]),s("v-list-item",[s("v-list-item-content",[s("v-list-item-title",[e._v("Multiple Workers")]),s("v-list-item-subtitle",[s("v-row",{staticClass:"d-flex flex-wrap"},[s("p",{staticClass:"ma-5",staticStyle:{bottom:"-1.5px",position:"relative"}},[e._v(" "+e._s(e.settings.multipleWorkers)+" ")]),s("v-slider",{staticStyle:{"align-items":"center","max-width":"86%"},attrs:{dense:"","hide-details":"",max:"10",min:"1"},on:{change:e.saveSettings},model:{value:e.settings.multipleWorkers,callback:function(t){e.$set(e.settings,"multipleWorkers",t)},expression:"settings.multipleWorkers"}})],1),e._v(" Speeds up the image processing. A high amount of workers will cost alot of RAM, which might cause the website to crash.")],1)],1)],1),s("v-list-item",[s("v-list-item-content",[s("v-list-item-title",[e._v("Scale")]),s("v-list-item-subtitle",[s("v-row",{staticClass:"d-flex flex-wrap"},[s("p",{staticClass:"ma-5",staticStyle:{bottom:"-1.5px",position:"relative"}},[e._v(" "+e._s(e.settings.scale)+" ")]),s("v-slider",{staticStyle:{"align-items":"center","max-width":"86%"},attrs:{dense:"","hide-details":"",max:"5",min:"1"},on:{change:e.saveSettings},model:{value:e.settings.scale,callback:function(t){e.$set(e.settings,"scale",t)},expression:"settings.scale"}})],1),e._v(" Amount of scaling that is applied to the images. It can improve the results, but it will take more time to process.")],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},v=[],y={name:"Upload",data:()=>({images:[],settings:{multipleWorkers:3,scale:2},settingsDialog:null}),mounted(){this.loadSettings(),this.$refs.dropContainer.ondragover=this.$refs.dropContainer.ondragenter=function(e){e.preventDefault()},this.$refs.dropContainer.ondrop=async e=>{e.preventDefault();const t=[...e.dataTransfer.files];t.every(e=>e.type.match(/(application\/json)|(image\/)/))&&this.uploadFiles([...e.dataTransfer.files])},this.$refs.fileUpload.onchange=(async e=>{this.uploadFiles([...e.target.files])}).bind(this)},methods:{saveSettings(){window.localStorage.setItem("settings",JSON.stringify(this.settings))},loadSettings(){window.localStorage.getItem("settings")&&(this.settings=JSON.parse(window.localStorage.getItem("settings")))},async uploadFiles(e){const t=e.find(e=>e.type.match(/application\/json/));if(t){let e=new FileReader;return e.onload=function(e){const t=JSON.parse(e.target.result),s=t.members.concat(t.enemies);t.logs.map(e=>{const t=s.find(t=>t.name==e.person1),a=s.find(t=>t.name==e.person2);e.person1=t,e.person2=a,t.logs||(t["logs"]=[]),a.logs||(a["logs"]=[]),t.logs.push(e),a.logs.push(e),e.time=e.time?new Date(e.time):null}),this.$router.push({name:"Results",params:{results:t}})}.bind(this),void e.readAsText(t)}let s=e.filter(e=>!this.images.find(t=>t.name==e.name));this.images=this.images.concat(s)}}},b=y,w=(s("ff95"),s("0b6a"),s("40dc")),_=s("8336"),x=s("b0af"),k=s("99d9"),C=s("a523"),S=s("169a"),P=s("ce7e"),T=s("ce87"),V=s("132d"),O=s("8860"),G=s("da13"),A=s("5d23"),j=s("0fd9"),L=s("8dd9"),D=s("ba0d"),I=s("2fa4"),$=s("e0c7"),R=s("71d9"),U=s("2a7f"),M=Object(o["a"])(b,f,v,!1,null,"7ffc0892",null),z=M.exports;d()(M,{VApp:u["a"],VAppBar:w["a"],VBtn:_["a"],VCard:x["a"],VCardText:k["a"],VContainer:C["a"],VDialog:S["a"],VDivider:P["a"],VHover:T["a"],VIcon:V["a"],VList:O["a"],VListItem:G["a"],VListItemContent:A["a"],VListItemSubtitle:A["b"],VListItemTitle:A["c"],VMain:g["a"],VRow:j["a"],VSheet:L["a"],VSlider:D["a"],VSpacer:I["a"],VSubheader:$["a"],VToolbar:R["a"],VToolbarItems:U["a"],VToolbarTitle:U["b"]});var E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"page",attrs:{id:"inspire"}},[s("v-main",{staticClass:"pt-0",staticStyle:{display:"flex","align-items":"center"}},[s("v-container",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[s("v-sheet",{staticClass:"ma-5",staticStyle:{overflow:"hidden","background-color":"#121212",border:"solid #2196f3 2px"},attrs:{rounded:"",height:3!=e.stepper?"40vh":"",width:"40%"}},[s("v-stepper",{staticStyle:{"text-align":"center","background-color":"#121212"},attrs:{"alt-labels":"",elevation:"0"},model:{value:e.stepper,callback:function(t){e.stepper=t},expression:"stepper"}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{step:"1"}},[e._v(" Scaling Images ")]),s("v-divider"),s("v-stepper-step",{attrs:{step:"2"}},[e._v(" Tesseract analyzing ")]),s("v-divider"),s("v-stepper-step",{attrs:{step:"3"}},[e._v(" Results ")])],1)],1),s("v-container",{staticStyle:{height:"100%","text-align":"center"}},[2==e.stepper?s("div",{staticClass:"pb-3"},[e._v(e._s(e.getProgress())+"%")]):e._e(),e.stepper<3?s("div",{staticStyle:{display:"flex","justify-content":"space-evenly","max-height":"60%","overflow-y":"auto","flex-wrap":"wrap"}},[e._l(e.images,(function(t){return s("v-card",{key:t.name,staticClass:"ma-1",staticStyle:{width:"115px"}},[s("v-app-bar",{attrs:{dense:"",flat:"",color:"rgba(0, 0, 0, 0)",elevation:"0"}},[s("v-toolbar-title",{staticClass:"white--text pl-0 text-center",staticStyle:{width:"100%"}},[e._v(" "+e._s(t.name)+" ")])],1),s("v-card-text",{staticClass:"text-center pt-0"},[s("v-progress-linear",{ref:t.name,refInFor:!0,attrs:{value:100,indeterminate:!t.finished}})],1)],1)})),e._l(10,(function(e){return s("v-card",{key:e,staticClass:"mx-1",staticStyle:{"background-color":"transparent"},attrs:{flat:"",height:"0",width:"115"}})}))],2):e._e(),3==e.stepper&&e.results.messages?s("div",[s("p",[e._v(" Correctly recognized "+e._s(e.results.messages-e.results.errors)+"/"+e._s(e.results.messages)+" ("+e._s(Math.floor((e.results.messages-e.results.errors)/e.results.messages*100))+"%) messages in "+e._s(Math.round(e.time))+" seconds. ")]),s("p",[e._v(" Found "+e._s(e.results.enemies.length+e.results.members.length)+" players, distributed over "+e._s(e.results.guilds.length+1)+" guilds. ")]),s("p",[e._v(" The war started "+e._s(e.results.logs[0].time.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))+" and ended at "+e._s(e.getLastLogTime()?e.getLastLogTime().time.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-")+". ")])]):e._e(),e.results.messages?s("v-row",{staticClass:"justify-center mt-5",staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[s("v-btn",{ref:"analyzeButton",staticClass:"mb-2",attrs:{outlined:"",color:"primary",dark:""},on:{click:function(t){return e.$router.push({name:"Results",params:{results:e.results}})}}},[e._v("Show details")]),s("v-btn",{attrs:{outlined:"",color:"yellow darken-2",dark:""},on:{click:function(t){return e.exportResults()}}},[e._v("Export")])],1):e._e()],1),s("div",{staticClass:"d-flex justify-center mt-5"},[s("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{value:e.forceUpdate,color:"primary"}})],1)],1)],1)],1)],1)},F=[];s("13d5"),s("5b81"),s("a1f0");const W=s("c9bf");class J{constructor(e,t,s){this.person1=e,this.person2=t,this.time=s}getObject(){return{person1:this.person1.name,person2:this.person2.name,time:this.time}}}class N{constructor(e,t=""){this.name=e,this.guild=t,this.kills=0,this.deaths=0,this.logs=[]}addKill(e,t){this.kills++,this.logs.push(new J(this,e,t))}addDeath(e,t){this.deaths++,this.logs.push(new J(e,this,t))}static findOrCreatePerson(e,t,s=""){let a=e.find(e=>B(e.name,t)>=.6);if(a)return a;let i=new N(t,s);return e.push(i),i}getInfo(){return`${this.name} | Kills: ${this.kills} | Deaths: ${this.deaths} | Guild: ${this.guild}`}getObject(){return{name:this.name,guild:this.guild,kills:this.kills,deaths:this.deaths}}}function B(e,t){if(e=e.replace(/\s+/g,""),t=t.replace(/\s+/g,""),e===t)return 1;if(e.length<2||t.length<2)return 0;let s=new Map;for(let i=0;i<e.length-1;i++){const t=e.substring(i,i+2),a=s.has(t)?s.get(t)+1:1;s.set(t,a)}let a=0;for(let i=0;i<t.length-1;i++){const e=t.substring(i,i+2),r=s.has(e)?s.get(e):0;r>0&&(s.set(e,r-1),a++)}return 2*a/(e.length+t.length-2)}var K={data(){return{images:[],currentImage:null,stepper:0,forceUpdate:0,forceUpdateInterval:null,results:{},scheduler:null,settings:{},time:0,workers:[],finished:!1}},async mounted(){if(this.images=[],this.stepper=2,this.forceUpdate=0,this.results={},clearInterval(this.forceUpdateInterval),this.forceUpdateInterval=null,this.scheduler&&(await this.scheduler.terminate(),this.scheduler=null),this.forceUpdateInterval=setInterval(()=>{this.forceUpdate++,100==this.forceUpdate&&(this.forceUpdate=0)},250),this.images=this.$route.params.images,this.settings=this.$route.params.settings,!this.images)return;this.images=this.images.map(e=>(e["loading"]=0,e["finished"]=!1,e));const e=(new Date).getTime();let t=[];for(let a=0;a<this.images.length;a++){const e=this.images[a];t.push(await this.scaleImage(e)),e.loading=100}this.stepper=2,this.images.map(e=>e.loading=0);const s=await this.analyze(t);this.stepper=3,this.results=this.analyzeResults(s),this.time=((new Date).getTime()-e)/1e3},methods:{exportResults(){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(JSON.stringify({enemies:this.results.enemies.map(e=>e.getObject()),members:this.results.members.map(e=>e.getObject()),guilds:this.results.guilds,logs:this.results.logs.map(e=>e.getObject()),errors:this.results.errors,messages:this.results.messages}))),e.setAttribute("download",`war-${this.results.guilds.join("-")}.json`),document.body.appendChild(e),e.click(),document.body.removeChild(e)},getLastLogTime(){for(let e=this.results.logs.length-1;e>=0;e--){const t=this.results.logs[e];if(null!=t.time)return t}return null},scaleImage(e){const t=this.settings.scale;return new Promise((s,a)=>{let i=new FileReader;i.onerror=a,i.onload=function(e){var a=document.createElement("img");a.src=e.target.result,a.onload=()=>{var e=document.createElement("canvas"),i=a.width,r=a.height;e.width=i*t,e.height=r*t;var l=e.getContext("2d");l.drawImage(a,0,0,i*t,r*t),s(e)}},i.readAsDataURL(e)})},getProgress(){if(!this.images)return 0;const e=this.workers.reduce((e,t)=>e+t.totalProgress+t.progress,0);return this.finished?100:Math.round(e/this.images.length*100)},async analyze(e){if(0==e.length)return;this.scheduler=W.createScheduler();const t=this.settings.multipleWorkers>e.length?e.length:this.settings.multipleWorkers;for(let a=0;a<t;a++){const e=W.createWorker({logger:e=>{if("recognizing text"==e.status&&e.workerId){let t=this.workers.find(t=>t.id==e.workerId);t||(t={id:e.workerId,progress:e.progress,totalProgress:0},this.workers.push(t)),t.progress=e.progress,1==t.progress&&(t.totalProgress+=1,t.progress=0)}}});await e.load(),await e.loadLanguage("eng"),await e.initialize("eng"),this.scheduler.addWorker(e)}const s=await Promise.all(e.map(async t=>{const s=await this.scheduler.addJob("recognize",t);return this.images[e.indexOf(t)].finished=!0,s}));return this.finished=!0,await this.scheduler.terminate(),this.scheduler=null,s},analyzeResults(e){const t=.6;let s=0,a=0,i=[],r=[],l=[],n=[];return e.forEach(e=>{let o=[];e.data.lines.map(e=>{s++;let n=e.text,c=n.match(/\(\w{2}:\w{2}\)/),d=null;if(c){let e=c[0];n=n.replace(c[0],""),e=e.replaceAll("CO","00");for(let s=0;s<10;s++)e=e.replaceAll("C"+s,"0"+s);const t=e.match(/\((\d{2}):(\d{2})\)/);if(t){const[e,s,a]=t;d=new Date(1,1,1),"00"==s&&(d=new Date(1,1,2)),d.setHours(s),d.setMinutes(a)}}n=n.replaceAll("(","["),n=n.replaceAll(")","]"),n=n.replaceAll("}","]"),n=n.replaceAll("{","["),n=n.replaceAll(" ",""),n=n.replaceAll("!","I"),n=n.replaceAll("$","S"),n=n.replaceAll("Â¥","Y"),n=n.replaceAll("1","I"),n=n.replaceAll(":",""),n=n.replaceAll("%","");let u=[...n.matchAll(/\[(\w*)\]/g)];if(u=u.map(e=>e[1]),u.length<3||u[0].length<2||u[1].length<2||u[2].length<2){if(2==u.length){let e=n.replace(u[0],"").replace(u[1],"").split("]")[1].split("[")[0];if(B(e,"forcefullyslaughtered")>=t||B(e,"wasunfairlykilledjby")>=t)return}return void a++}let g=n.replace(u[0],"").replace(u[1],"").replace(u[2],"").split("]")[1].split("[")[0];const h=u[0],p=u[1];let m=u[2];const f=l.find(e=>B(m,e)>=t);f?m=f:l.push(m);let v=N.findOrCreatePerson(i,h),y=N.findOrCreatePerson(r,p,m);g.length>7?(v.addDeath(y,d),y.addKill(v,d),o.push(new J(y,v,d))):(v.addKill(y,d),y.addDeath(v,d),o.push(new J(v,y,d)))});let c=null;for(let t=0;t<o.length;t++){let e=o[t];c?e.time<c.time&&(e.time=null):c=e}n=n.concat(o)}),n.sort((e,t)=>e.time<t.time?-1:1),i.concat(r).map(e=>e.logs.sort((e,t)=>e.time<t.time?-1:1)),i.sort((e,t)=>t.kills-e.kills),r.sort((e,t)=>t.kills-e.kills),{members:i,enemies:r,guilds:l,errors:a,messages:s,logs:n}}}},H=K,Y=(s("2984"),s("490a")),q=s("8e36"),Q=s("7e85"),X=s("9c54"),Z=s("56a4"),ee=Object(o["a"])(H,E,F,!1,null,null,null),te=ee.exports;d()(ee,{VApp:u["a"],VAppBar:w["a"],VBtn:_["a"],VCard:x["a"],VCardText:k["a"],VContainer:C["a"],VDivider:P["a"],VMain:g["a"],VProgressCircular:Y["a"],VProgressLinear:q["a"],VRow:j["a"],VSheet:L["a"],VStepper:Q["a"],VStepperHeader:X["a"],VStepperStep:Z["a"],VToolbarTitle:U["b"]});var se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"page",attrs:{id:"inspire"}},[s("v-main",{staticClass:"pt-0",staticStyle:{display:"flex","align-items":"center"}},[s("div",{staticClass:"d-flex justify-center"},[s("v-btn",{attrs:{outlined:"","x-large":"",color:"primary",dark:""},on:{click:function(t){return e.changeGuild("")}}},[e._v("You vs "+e._s(e.getGuildNames()))])],1),s("v-container",[s("v-row",[s("v-col",{attrs:{cols:"12",sm:"2"}},[s("v-sheet",{staticClass:"sideContainer",attrs:{rounded:"lg","min-height":"268"}},e._l(e.results.members,(function(t){return s("v-card",{key:t.name,staticClass:"ma-2",staticStyle:{border:"solid #2196f3 2px"},on:{click:function(s){return e.updateGraph(t)}}},[s("v-card-title",{attrs:{"primary-title":""}},[s("div",{staticClass:"text-center",staticStyle:{width:"100%"}},[s("h3",{staticClass:"headline mb-0"},[e._v(e._s(t.name))]),s("div",[e._v(e._s(t.kills)+"-"+e._s(t.deaths))])])])],1)})),1)],1),s("v-col",{attrs:{cols:"12",sm:"8"}},[s("v-sheet",{staticStyle:{overflow:"hidden","background-color":"#121212",border:"solid #2196f3 2px"},attrs:{"min-height":"70vh",rounded:""}},[s("v-sheet",{staticStyle:{overflow:"hidden","background-color":"#121212",border:"solid #2196f3 2px"},attrs:{rounded:"","min-height":"40vh"}},[s("canvas",{ref:"graph"})]),e.selectedPlayer.name?s("v-container",[e._v(" "+e._s(e.selectedPlayer.name)+" "),s("v-divider"),s("p",[e._v(" Kills: "+e._s(e.selectedPlayer.kills)+" "),s("br"),e._v(" Deaths: "+e._s(e.selectedPlayer.deaths)+" "),s("br"),e._v(" Kd: "+e._s((e.selectedPlayer.kills/e.selectedPlayer.deaths).toFixed(2))+" "),s("br")]),e.getLastLogTime(e.selectedPlayer.logs)?s("div",[e._v(" "+e._s(e.toLocalString(e.selectedPlayer.logs[0].time))+" - "+e._s(e.toLocalString(e.getLastLogTime(e.selectedPlayer.logs)))+" ("+e._s(e.getPlayedTime(e.selectedPlayer))+" min, "+e._s(Math.round(e.getPlayedTime(e.selectedPlayer)/((e.getLastLogTime(e.results.logs).getTime()-e.results.logs[0].time.getTime())/6e4)*100))+"%) ")]):e._e()],1):e.results.logs.length>0?s("v-container",[e._v(" "+e._s(""==e.selectedGuild?"Your":e.selectedGuild)+" stats "),s("v-divider"),s("p",[e._v(" Avg kills: "+e._s((e.getPlayersOfGuild(e.selectedGuild).reduce((function(e,t){return e+t.kills}),0)/e.getPlayersOfGuild(e.selectedGuild).length).toFixed(2))+" "),s("br"),e._v(" Avg deaths: "+e._s((e.getPlayersOfGuild(e.selectedGuild).reduce((function(e,t){return e+t.deaths}),0)/e.getPlayersOfGuild(e.selectedGuild).length).toFixed(2))+" "),s("br"),e._v(" Avg kd: "+e._s((e.getPlayersOfGuild(e.selectedGuild).reduce((function(e,t){return e+t.kills}),0)/e.getPlayersOfGuild(e.selectedGuild).length/(e.getPlayersOfGuild(e.selectedGuild).reduce((function(e,t){return e+t.deaths}),0)/e.getPlayersOfGuild(e.selectedGuild).length)).toFixed(2))+" "),s("br"),e._v(" Avg time: "+e._s(Math.round(e.getPlayersOfGuild(e.selectedGuild).reduce((function(t,s){return t+e.getPlayedTime(s)}),0)/e.getPlayersOfGuild(e.selectedGuild).length))+" min ("+e._s(Math.round(e.getPlayersOfGuild(e.selectedGuild).reduce((function(t,s){return t+e.getPlayedTime(s)}),0)/e.getPlayersOfGuild(e.selectedGuild).length/((e.getLastLogTime(e.results.logs).getTime()-e.results.logs[0].time.getTime())/6e4)*100))+"%) "),s("br"),e._v(" Members: "+e._s(e.getPlayersOfGuild(e.selectedGuild).length)+" ")]),""==e.selectedGuild?s("p",[e._v(" You had "+e._s(e.results.members.length)+" members and fought "+e._s(e.results.enemies.length)+" people. ")]):e._e()],1):e._e()],1),s("div",{staticClass:"d-flex justify-center mt-5"},[s("v-btn",{attrs:{outlined:"","x-large":"",color:"yellow darken-2",dark:""},on:{click:function(t){return e.exportResults()}}},[e._v("Export")])],1)],1),s("v-col",{staticStyle:{"max-height":"70vh","overflow-y":"auto","margin-top":"12px","padding-top":"0","padding-bottom":"0"},attrs:{cols:"12",sm:"2"}},e._l(e.results.guilds,(function(t){return s("v-sheet",{key:t,staticClass:"mb-3",attrs:{rounded:"lg",color:"#121212"}},[s("div",{staticClass:"d-flex justify-center mb-1"},[s("v-btn",{attrs:{outlined:"",color:"primary",dark:""},on:{click:function(s){return e.changeGuild(t)}}},[e._v(e._s(t))])],1),s("div",{style:e.calcContainerHeight()},e._l(e.results.enemies.filter((function(e){return e.guild==t})),(function(t){return s("v-card",{key:t.name,staticClass:"ma-2",staticStyle:{border:"solid #2196f3 2px"},on:{click:function(s){return e.updateGraph(t)}}},[s("v-card-title",{attrs:{"primary-title":""}},[s("div",{staticClass:"text-center",staticStyle:{width:"100%"}},[s("h3",{staticClass:"headline mb-0"},[e._v(e._s(t.name))]),s("div",[e._v(e._s(t.kills)+"-"+e._s(t.deaths))])])])],1)})),1)])})),1)],1)],1)],1)],1)},ae=[];const{Chart:ie,registerables:re}=s("9b4a");var le={data(){return{results:{members:[],enemies:[],allPlayers:[],guilds:[],errors:0,messages:0,logs:[]},timeData:[],selectedPlayer:{},selectedGuild:"",graph:null}},async mounted(){this.$route.params.results&&(this.results=this.$route.params.results,this.results["allPlayers"]=this.results.members.concat(this.results.enemies),this.getTimeData())},methods:{getLastLogTime(e){for(let t=e.length-1;t>=0;t--){const s=e[t];if(s&&null!=s.time)return s.time}return null},getGuildNames(){return this.results.guilds.join(", ")},calcContainerHeight(){return 1==this.results.guilds.length?"overflow-y:auto;max-height:65.7vh":`overflow-y:auto;max-height:calc(60vh/${this.results.guilds.length})`},getPlayedTime(e){return this.getLastLogTime(e.logs)?(this.getLastLogTime(e.logs).getTime()-e.logs[0].time.getTime())/6e4:0},exportResults(){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(JSON.stringify({enemies:this.results.enemies.map(e=>({name:e.name,kills:e.kills,deaths:e.deaths,guild:e.guild})),members:this.results.members.map(e=>({name:e.name,kills:e.kills,deaths:e.deaths,guild:e.guild})),guilds:this.results.guilds,logs:this.results.logs.map(e=>({person1:e.person1.name,person2:e.person2.name,time:e.time})),errors:this.results.errors,messages:this.results.messages}))),e.setAttribute("download",`war-${this.results.guilds.join("-")}.json`),document.body.appendChild(e),e.click(),document.body.removeChild(e)},changeGuild(e){this.selectedGuild=e,this.graph.data.datasets.length>1&&(this.graph.data.datasets.pop(),this.graph.update(),this.selectedPlayer={})},getTimeData(){const e=[];this.results.logs.map(t=>{null==t.time||e.find(e=>e.getTime()==t.time.getTime())||e.push(t.time)}),e.forEach(e=>{const t=this.results.logs.filter(t=>null!=t.time&&t.time.getTime()==e.getTime()),s=t.reduce((e,t)=>""==t.person1.guild?e+1:e-1,0);this.timeData.push({time:e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),direction:s})});const t=this.timeData.map(e=>e.time),s=this.timeData.map(e=>e.direction),a={labels:t,datasets:[{label:"Performance",backgroundColor:"rgba(0,0,0,0)",borderColor:"rgba(0,0,0,0)",fill:{target:"origin",above:"#03A9F4",below:"#F44336"},spanGaps:!0,data:s,tension:.1,order:2}]},i={type:"line",data:a,options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}}}};ie.register(...re),this.graph=new ie(this.$refs.graph,i)},getPlayersOfGuild(e){return this.results.allPlayers.filter(t=>t.guild==e)},updateGraph(e){const t=this.timeData.map(t=>{const s=e.logs.find(e=>this.toLocalString(e.time)==t.time);if(s){const t=e.logs.filter(e=>null!=e.time&&e.time.getTime()==s.time.getTime()),a=t.reduce((e,t)=>""==t.person1.guild?e+1:e-1,0);return a}return null});if(this.graph.data.datasets.length>1){const e=this.graph.data.datasets.pop();if(e.data.every((e,s)=>e==t[s]))return this.graph.update(),void(this.selectedPlayer={})}this.selectedPlayer=e,this.graph.data.datasets.push({label:e.name,backgroundColor:"rgba(50,125,180,1)",borderColor:"rgba(255,255,255,1)",spanGaps:!0,data:t,tension:.1,order:1}),this.graph.update()},toLocalString(e){return e?e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}}},ne=le,oe=(s("fd2d"),s("62ad")),ce=Object(o["a"])(ne,se,ae,!1,null,"1d73be65",null),de=ce.exports;d()(ce,{VApp:u["a"],VBtn:_["a"],VCard:x["a"],VCardTitle:k["b"],VCol:oe["a"],VContainer:C["a"],VDivider:P["a"],VMain:g["a"],VRow:j["a"],VSheet:L["a"]}),a["a"].use(m["a"]);const ue=[{path:"/",name:"Upload",component:z},{path:"/analyze",name:"Analyze",component:te},{path:"/results",name:"Results",component:de}],ge=new m["a"]({mode:"history",base:"/OUTDATED-war-analyzer/",routes:ue});var he=ge,pe=s("2f62");a["a"].use(pe["a"]);var me=new pe["a"].Store({state:{},mutations:{},actions:{},modules:{}}),fe=s("f309");a["a"].use(fe["a"]);var ve=new fe["a"]({theme:{dark:!0}});a["a"].config.productionTip=!1,new a["a"]({router:he,store:me,vuetify:ve,render:e=>e(p)}).$mount("#app")},7013:function(e,t,s){},"85ec":function(e,t,s){},"8c67":function(e,t,s){},da8c:function(e,t,s){},fd2d:function(e,t,s){"use strict";s("7013")},ff95:function(e,t,s){"use strict";s("da8c")}});
//# sourceMappingURL=app.d6f3a85b.js.map